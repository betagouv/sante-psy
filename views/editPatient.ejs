<%- include('partials/header', { isInPsychologistPages: true }) -%>

<div class="rf-container rf-mb-5w">
  <%- include('partials/ariane',
  {
    items: [
        {
          label: 'Déclarer mes séances',
          url: '/psychologue/mes-seances'
        },
        {
          label: pageTitle,
        },
    ],
  })
  -%>
  <h1>
    <%= pageTitle %>
  </h1>
  <div class="rf-mb-5w">
    <div>
      <%= pageIntroText %>
    </div>
  </div>
  <% if (errors.length) { %>
    <% errors.forEach(function(error) { %>
      <%- include('partials/notificationError', {error: error}) -%>
    <% }) %>
  <% } %>
  <% if (infos.length) { %>
    <% infos.forEach(function(info) { %>
      <%- include('partials/notificationInfo', {info: info}) -%>
    <% }) %>
  <% } %>
  <div class="rf-my-5w">
    <form action="<%= form.action %>" method="<%= form.method %>">
      <div class="rf-text--sm">
        Les champs avec une astérique (<span class="red-text">*</span>) sont obligatoires.
      </div>
      <div class="rf-text--sm">
        S'il vous manque des champs non-obligatoires, vous pourrez y revenir plus tard pour compléter le dossier.
      </div>
      <input type="hidden" name="_csrf" value="<%= _csrf  %>">
      <div>
        <div class="rf-my-3w">
          <label class="rf-label" for="firstnames">Prénoms <span class="red-text">*</span></label>
          <input class="rf-input midlength-input" value="<%= patient.firstNames %>" type="text" id="firstnames" name="firstnames" required>
        </div>
        <div class="rf-my-3w">
          <label class="rf-label" for="lastname">Nom <span class="red-text">*</span></label>
          <input class="rf-input midlength-input" value="<%= patient.lastName %>"  type="text" id="lastname" name="lastname" required>
        </div>
        <div class="rf-my-3w">
          <label class="rf-label" for="dateofbirth">Date de naissance</label>
          <div class="rf-hint-text" id="dateofbirth-help">
            Date au format JJ/MM/AAAA, exemple : 25/01/1987
          </div>
          <input class="rf-input midlength-input" value="<%= date.toFormatDDMMYYYY(patient.dateOfBirth) %>" 
          type="text"
          pattern="^([0-2][0-9]|(3)[0-1])(\/)(((0)[0-9])|((1)[0-2]))(\/)\d{4}$"
          title="Utilisez 2 chiffres pour les jours, et le mois, et 4 chiffres pour l'année"
          placeholder="Exemple de format : 25/01/1987"
          id="dateofbirth" name="dateofbirth">
        </div>
        <div class="rf-my-3w">
          <label class="rf-label" for="institution" aria-describedby="institution-help">Établissement scolaire de l'étudiant</label>
          <div class="rf-hint-text" id="institution-help">
            Exemple : Université de Rennes ou ENSAE
          </div>
          <input class="rf-input midlength-input" value="<%= patient.institutionName %>"  type="text" id="institution" name="institution">
        </div>
        <div class="rf-my-3w">
          <!-- todo : JS validation for 11 digit number -->
          <label class="rf-label" for="ine" aria-describedby="ine-help">Numéro INE de l'étudiant (optionnel)</label>
          <div class="rf-hint-text" id="ine-help">
            Il fait 11 caractères (chiffres et lettres). Il peut être présent sur la carte d'étudiant.
          </div>
          <input class="rf-input short-input" value="<%= patient.INE %>" type="text" id="ine" name="ine" maxlength="11" size="11">
        </div>
        <div class="rf-my-3w rf-checkbox-group">
          <input type="checkbox" id="isstudentstatusverified" name="isstudentstatusverified" value="isstudentstatusverified" <% if(patient.isStudentStatusVerified){ %> checked="checked" <% } %> >
          <label class="rf-label" for="isstudentstatusverified">
            J'ai vérifié le statut étudiant de ce patient
            <span class="rf-hint-text">J'ai vu sa carte d'étudiant ou un autre justificatif</span>
          </label>
        </div>
        <div class="rf-my-3w rf-checkbox-group">
          <input type="checkbox" id="hasprescription" name="hasprescription" value="hasprescription" <% if(patient.hasPrescription){ %> checked="checked" <% } %> >
          <label class="rf-label" for="hasprescription">
            J'ai vérifié que les séances ont bien été prescrites par un médecin ou un Service de Santé Universitaire
            <span class="rf-hint-text">L'étudiant m'a présenté une lettre ou ordonnance médicale</span>
          </label>
        </div>
        <div class="rf-my-3w">
          <label class="rf-label" for="doctorname" aria-describedby="doctorname-help">
            Médecin ou Service de Santé Universitaire qui a orienté ce patient
          </label>
          <div class="rf-hint-text" id="doctorname-help">
            Exemple : Annie Benahmou ou SSU Rennes 1
          </div>
          <input class="rf-input midlength-input" value="<%= patient.doctorName %>"  type="text" id="doctorname" name="doctorname">
        </div>
        <div class="rf-my-3w">
          <label class="rf-label" for="doctoraddress" aria-describedby="doctoraddress-help">
            Ville et/ou code postal du médecin ou Service de Santé Universitaire
          </label>
          <div class="rf-hint-text" id="doctoraddress-help">
            Exemple : 97400 Saint-Denis
          </div>
          <input class="rf-input midlength-input" value="<%= patient.doctorAddress %>"  type="text" id="doctoraddress" name="doctoraddress">
        </div>
      </div>
      <div class="rf-my-5w">
        <input hidden name="patientid" value="<%= patient.id %>" />
        <button type="submit" class="rf-btn rf-btn--icon-left <%= form.submitButtonIcon %>"><%= form.submitButtonText %></button>
      </div>
    </form>
  </div>
  <div>
    Des questions ? Une difficulté ? Envoyez-nous un email à <b><%= contactEmail %></b>.
  </div>
</div>
</br>

<%- include('partials/footer') -%>
