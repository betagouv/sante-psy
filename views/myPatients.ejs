<%- include('partials/header', { isInPsychologistPages: true }) -%>

<div class="fr-container fr-mb-3w fr-mt-2w">
  <%- include('partials/announcement') -%>
  <h1>Gérer mes patients</h1>
  <%- include('partials/notifications') -%>
  <div class="fr-grid-row fr-grid-row--left">
    <div class="fr-col-12">
      <h2 class="fr-mb-2w">
        Mes patients
      </h2>
      <div class="fr-mb-2w">
        <a href="/psychologue/nouveau-patient" class="fr-btn fr-fi-add-line fr-btn--icon-left">Nouveau patient</a>
      </div>
      <div>
        <% if (patients.length) { %>
          <% if (patients.find((patient) => !patient.hasFolderCompleted)) { %>
          <div class="fr-callout fr-mb-2w">
              <p class="fr-text--md fr-mb-1v">
              Certains de vos patients n‘ont pas leur dossier complet - vérification du statut d‘étudiant, l‘orientation du medecin, le nom du medecin, sa ville,
              ou l‘université du patient, ou date de naissance (obligatoire uniquement pour vos patients enregistrés après le <%= dateOfBirthDeploymentDate %>) sont manquants.
              <br/>
              <strong>
                Ceci est obligatoire pour facturer les séances du patient.
              </strong>
              </p>
            </div>
          <% } %>
          <div class="fr-table">
            <table>
              <thead>
                  <tr>
                    <th scope="col">
                      Nom
                    </th>
                    <th scope="col">
                      Prenom
                    </th>
                    <th scope="col">
                      Statut
                    </th>
                    <th scope="col"></th>
                  </tr>
                </thead>
              <tbody>
                <%- include('patients', {patients: patients.filter(patient => !patient.hasFolderCompleted)}) -%>
                <%- include('patients', {patients: patients.filter(patient => patient.hasFolderCompleted)}) -%>
              </tbody>
            </table>
          </div>
        <% } else { %>
          <span>Vous n‘avez pas encore déclaré de patients.</span>
        <% } %>
      </div>
    </div>
  </div>
  <div class="fr-my-4w">
    Des questions ? Une difficulté ? Envoyez-nous un email à <b><%= contactEmail %></b>.
  </div>
</div>

<%- include('partials/footer') -%>
